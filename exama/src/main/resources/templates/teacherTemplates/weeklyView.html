<html lang="DE" xmlns:th="http://www.thymeleaf.org"
    xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<head th:include="fragments/head :: head"></head>

<body>
    <div id="wrapper">
        <!-- header with navigation (only desktop and tablet), title and logout-button -->
        <div th:include="fragments/header :: header"></div>

        <div th:include="fragments/coursenavigation :: coursenavigation"></div>

        <!-- content displayed in the center of the window -->
        <div id="content-wrapper">
            <h1>Wochenansicht</h1>
            <a th:with="urlBuilder=${T(org.springframework.web.servlet.support.ServletUriComponentsBuilder).fromCurrentRequest()}"
                th:href="${urlBuilder.replaceQueryParam('view', '1').toUriString()}">> Workload Diagramm</a><br><br>
            <a th:href="@{/calendarchoose?view=3&coreCourse={cc}(cc=${coreCourse.id})}">> Semesteransicht</a><br><br>
            <!-- @ Roman: vielleicht wäre es cool, wenn die Seite auch auf calendar&view=3... gemappt würde. aber besprechen wir noch, wo was hin kommt :-) -->

            <h2>Klasse [[${coreCourse.name}]]</h2>
            <h3>Woche vom Montag, [[${#temporals.format(monday, 'dd.MM.yyyy')}]]</h3>
            <a th:with="urlBuilder=${T(org.springframework.web.servlet.support.ServletUriComponentsBuilder).fromCurrentRequest()}"
                th:href="${urlBuilder.replaceQueryParam('monday', #temporals.format(#temporals.createNow(), 'yyyy-MM-dd')).toUriString()}">zur Aktuellen Woche</a><br><br>
            <a th:with="urlBuilder=${T(org.springframework.web.servlet.support.ServletUriComponentsBuilder).fromCurrentRequest()}"
                th:href="${urlBuilder.replaceQueryParam('monday', lastMonday).toUriString()}">&lt; vorherige Woche</a> |
            <a th:with="urlBuilder=${T(org.springframework.web.servlet.support.ServletUriComponentsBuilder).fromCurrentRequest()}"
                th:href="${urlBuilder.replaceQueryParam('monday', nextMonday).toUriString()}">nächste Woche &gt;</a><br><br>
            <table>
                <thead>
                    <tr>
                        <th>Typ</th>
                        <th>Name</th>
                        <th>Datum</th>
                        <th>Fach</th>
                        <th>Aufwand</th>
                        <th>Vorbereitungsintervall / Startdatum</th>
                        <th>Faktor (nur PR)</th>
                        <th>Pruefungstyp (nur PR)</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="assignment : ${assignments}" th:style="${assignment.class.simpleName} == 'Exam' ? 'font-weight:bold;'">
                        <td th:text="${assignment.class.simpleName} == 'Exam' ? 'PR' : 'HA'"></td>
                        <td th:text="${assignment.name}"></td>
                        <td th:text="${#temporals.format(assignment.dueDate, 'dd.MM.yyyy')}"></td>
                        <td th:text="${assignment.course.subject} + ' (' + ${assignment.course} + ')'"></td>
                        <td th:text="${assignment.workloadMinutesTotal} == 0 ? ${assignment.examType.timeValue}+'h' : ${assignment.workloadMinutesTotal}+'min'"></td>
                        <td th:text="${assignment.getAvailableDaysTotal} + ' Tage / '+${#temporals.format(assignment.getRealStartDate, 'dd.MM.yyyy')}"></td>
                        <td th:text="${assignment.class.simpleName} == 'Exam' ? ${assignment.countingFactor} : '-'"></td>
                        <td th:text="${assignment.class.simpleName} == 'Exam' ? ${assignment.examType.getName()} : '-'"></td>
                        <td>ansehen</td>
                    </tr>
                </tbody>
            </table>

        </div>

        <!-- footer with navigation (only mobile) -->
        <div th:include="fragments/footer :: footer"></div>
</body>

</html>